<!DOCTYPE html>
<!--[if IE]><![endif]-->
<html>

    <head>
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
      <title>Holmes | FastActivator API Reference </title>
      <meta name="viewport" content="width=device-width">
      <meta name="title" content="Holmes | FastActivator API Reference ">
      <meta name="generator" content="docfx ">
  
      <link rel="shortcut icon" href="favicon.ico">
      <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/styles/night-owl.min.css">
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.7.2/font/bootstrap-icons.css" integrity="sha384-EvBWSlnoFgZlXJvpzS+MAUEjvN7+gcCwH+qh7GRFOGgZO0PuwOFro7qPOJnLfe7l" crossorigin="anonymous">
      <link rel="stylesheet" href="styles/config.css">
      <link rel="stylesheet" href="styles/discord.css">
      <link rel="stylesheet" href="styles/singulink.css">
      <link rel="stylesheet" href="styles/main.css">
      <meta property="docfx:navrel" content="toc.html">
      <meta property="docfx:tocrel" content="toc.html">
  
  <meta property="docfx:rel" content="">
  <meta property="docfx:newtab" content="true">
    </head>
    <body>
        <div class="top-navbar">
            <a class="burger-icon" onclick="toggleMenu()">
                <svg name="Hamburger" style="vertical-align: middle;" width="34" height="34" viewbox="0 0 24 24"><path fill="currentColor" fill-rule="evenodd" clip-rule="evenodd" d="M20 6H4V9H20V6ZM4 10.999H20V13.999H4V10.999ZM4 15.999H20V18.999H4V15.999Z"></path></svg>
            </a>


            <a class="brand" href="index.html">
              <img src="images/icon.png" alt="FastActivator" class="logomark">
              <span class="brand-title">FastActivator</span>
            </a>        </div>

        <div class="body-content">
            <div id="blackout" class="blackout" onclick="toggleMenu()"></div>

            <nav id="sidebar" role="navigation">
                <div class="sidebar">

                    <div>
                      <div class="mobile-hide">

                        <a class="brand" href="index.html">
                          <img src="images/icon.png" alt="FastActivator" class="logomark">
                          <span class="brand-title">FastActivator</span>
                        </a>                      </div>

                      <div class="sidesearch">
                        <form id="search" role="search" class="search">
                            <i class="bi bi-search search-icon"></i>
                            <input type="text" id="search-query" placeholder="Search" autocomplete="off">
                        </form>
                      </div>

                      <div id="navbar">
                      </div>
                    </div>                    <div class="sidebar-item-separator"></div>
                </div>
                <div class="footer">
  <strong><a href='https://github.com/JaCraig/FastActivator'>Open in Github</a></strong>
  
                </div>            </nav>

            <main class="main-panel">

                <div id="search-results" style="display: none;">
                  <h1 class="search-list">Search Results for <span></span></h1>
                  <div class="sr-items">
                    <p><i class="bi bi-hourglass-split index-loading"></i></p>
                  </div>
                  <ul id="pagination" data-first="First" data-prev="Previous" data-next="Next" data-last="Last"></ul>
                </div>
 

                <div role="main" class="hide-when-search">

                        <div class="subnav navbar navbar-default">
                          <div class="container hide-when-search" id="breadcrumb">
                            <ul class="breadcrumb">
                              <li></li>
                            </ul>
                          </div>
                        </div>

                         <div id="contribution">
                               <a href="https://github.com/JaCraig/Holmes/blob/master/docfx_project/index.md/#L1" class="contribution-link">Improve this Doc</a>
                         </div>

                    <article class="content wrap" id="_content" data-uid="">
<h1 id="holmes">Holmes</h1>

<p><a href="https://ci.appveyor.com/project/JaCraig/holmes"><img src="https://ci.appveyor.com/api/projects/status/w95i5th94ayc3f6q?svg=true" alt="Build status"></a></p>
<p>Holmes is a database analysis library. It scans a database and returns suggestions for improvement. Supports .Net Core as well as full .Net</p>
<h2 id="setting-up-the-library">Setting Up the Library</h2>
<p>In order to use Holmes, you need to start by wiring it up on your ServiceCollection. However this takes just one extension method call:</p>
<pre><code>serviceCollection.AddCanisterModules();
				
</code></pre>
<p>When this is done, Holmes is ready to use.</p>
<h2 id="basic-usage">Basic Usage</h2>
<p>The main class of interest is the Sherlock class:</p>
<pre><code>var Results = Sherlock.Analyze(new Connection(...));
</code></pre>
<p>The Sherlock class contains one function which is Analyze. This function takes a Connection object defining where the library should be pointed. It will then, based on the provider specified in the connection object, run any analysis classes that it has and returns a list of Finding objects. The Finding class looks like this:</p>
<pre><code>public class Finding
{
	public string Fix { get; }
	public IDictionary&lt;string, object&gt; Metrics { get; }
	public string Text { get; }
}
</code></pre>
<p>The Text property contains the explination of what was found, the Metrics property contains the data that was returned by the analysis object, and the Fix property contains the SQL command that can be used to remedy the issue. Note that not all analysis classes will contain a suggested fix. This is optional where as the other two properties will always contain some information.</p>
<h2 id="adding-your-own-analyzer">Adding Your Own Analyzer</h2>
<p>The system a couple of built in analyzers:</p>
<ul>
<li>SQL Server
<ul>
<li>Recent expensive queries</li>
<li>Missing indexes</li>
<li>Overlapping indexes</li>
<li>Unused indexes</li>
</ul>
</li>
</ul>
<p>However you can easily add your own analyzer by simply creating a class that inherits from IAnalyzer.  The system will then pick it up automatically and run it as well. For simple analyzers there is also an AnalyzerBaseClass that will simplify the process of setting up your analyzer. The IAnalyzer interface itself is rather simple though:</p>
<pre><code>public interface IAnalyzer
{
    /// &lt;summary&gt;
    /// Gets the factory the analyzer supports.
    /// &lt;/summary&gt;
    /// &lt;value&gt;Gets the factory the analyzer supports.&lt;/value&gt;
    DbProviderFactory SupportedFactory { get; }

    /// &lt;summary&gt;
    /// Adds the query the analyzer needs to the batch.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;batch&quot;&gt;The batch.&lt;/param&gt;
    /// &lt;returns&gt;This.&lt;/returns&gt;
    IAnalyzer AddQuery(SQLHelper.SQLHelper batch);

    /// &lt;summary&gt;
    /// Analyzes the specified connection's source database.
    /// &lt;/summary&gt;
    /// &lt;param name=&quot;results&quot;&gt;The results of the analysis.&lt;/param&gt;
    /// &lt;returns&gt;The list of suggestions for the database.&lt;/returns&gt;
    IEnumerable&lt;Finding&gt; Analyze(IEnumerable&lt;dynamic&gt; results);
}
</code></pre>
<p>The SupportedFactory property is the DbProviderFactory that this analyzer should be run against. All analyzer queries are batched together by the system and run at once. As such there is an AddQuery function. With this function the system passes you the SQLHelper object it is using to batch the various queries. The one method on that you will probably use is AddQuery. The only other method is Analyze. This method recieves the results of the query as a list of dynamic objects. The names of each property is the same as the result set of the query you specified previously. In turn you should return a list of Finding objects.</p>
<h2 id="installation">Installation</h2>
<p>The library is available via Nuget with the package name &quot;Holmes&quot;. To install it run the following command in the Package Manager Console:</p>
<pre><code>Install-Package Holmes
</code></pre>
<h2 id="build-process">Build Process</h2>
<p>In order to build the library you will require the following:</p>
<ol>
<li>Visual Studio 2022</li>
</ol>
<p>Other than that, just clone the project and you should be able to load the solution and build without too much effort.</p>
</article>
                </div>

                <div class="copyright-footer">
                    <span>&#169; James Craig. All rights reserved.</span>
                </div>
            </main>
        </div>


        <script src="https://code.jquery.com/jquery-3.6.3.min.js" integrity="sha256-pvPw+upLPUjgMXY0G+8O0xUf+/Im1MZjXxxgOcBQBXU=" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js" integrity="sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.min.js" integrity="sha384-+sLIOodYLS7CIrQpBjl+C7nPvqq+FbNUBDunl/OZv93DB7Ln/533i8e/mZXLi/P+" crossorigin="anonymous"></script>
        <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script>
        <script type="text/javascript" src="styles/jquery.twbsPagination.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/mark.js@8.11.1/dist/jquery.mark.min.js"></script>
        <script type="text/javascript" src="styles/url.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/anchor-js@5.0.0/anchor.min.js"></script>
        <script type="text/javascript" src="styles/docfx.js"></script>
        <script type="text/javascript" src="styles/main.js"></script>
        <script type="text/javascript" src="styles/singulink.js"></script>    </body>
</html>
